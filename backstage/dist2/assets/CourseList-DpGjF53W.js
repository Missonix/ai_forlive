import{x as e,r as a,h as l,y as t,P as u,H as r,ag as o,z as s,A as d,I as i,a4 as n,L as c,aq as p,G as v}from"./vue-vendor-B0tYOcBV.js";import{c as m}from"./course-O-FbVX8K.js";import{a as _,c as f}from"./element-plus-C6e0990v.js";import{_ as g}from"./_plugin-vue_export-helper-B34n5pss.js";const h={class:"course-list"},y={class:"card-header"},w={class:"search-bar"},C={class:"pagination-container"},b={class:"dialog-footer"},k=g(e({__name:"CourseList",setup(e){const g=a([]),k=a(!1),V=a(""),x=a(!1),z=a("add"),j=a(""),U=a(1),I=a(10),q=a(0),A=a(),L=a({course_name:""}),P={course_name:[{required:!0,message:"请输入课程名称",trigger:"blur"},{min:2,max:50,message:"课程名称长度在2-50个字符之间",trigger:"blur"}]},S=async()=>{try{k.value=!0;const e=await m.getAllCourses(U.value,I.value);g.value=e.data.data.items,q.value=e.data.data.total}catch(e){_.error("获取课程列表失败")}finally{k.value=!1}},D=async()=>{if(!V.value)return U.value=1,void(await S());try{k.value=!0;const e=await m.searchCourse(V.value);200===e.data.code?(g.value=e.data.data.items,q.value=e.data.data.total,0===g.value.length&&_.info("未找到匹配的课程")):_.error(e.data.message||"搜索失败")}catch(e){_.error("搜索课程失败")}finally{k.value=!1}},G=e=>{U.value=e,S()},H=e=>{I.value=e,U.value=1,S()},K=()=>{z.value="add",L.value={course_name:""},x.value=!0},R=async()=>{A.value&&await A.value.validate((async e=>{if(e)try{"add"===z.value?(await m.createCourse(L.value),_.success("创建成功")):(await m.updateCourse(j.value,L.value),_.success("更新成功")),x.value=!1,await S()}catch(a){_.error("add"===z.value?"创建失败":"更新失败")}}))};return l((()=>{S()})),(e,a)=>{const l=o("el-button"),B=o("el-input"),E=o("el-table-column"),F=o("el-button-group"),J=o("el-table"),M=o("el-pagination"),N=o("el-card"),O=o("el-form-item"),Q=o("el-form"),T=o("el-dialog"),W=p("loading");return s(),t("div",h,[u(N,null,{header:r((()=>[d("div",y,[a[7]||(a[7]=d("span",null,"课程管理",-1)),u(l,{type:"primary",onClick:K},{default:r((()=>a[6]||(a[6]=[c("新增课程")]))),_:1})])])),default:r((()=>[d("div",w,[u(B,{modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=e=>V.value=e),placeholder:"请输入课程名称搜索",class:"search-input",onKeyup:n(D,["enter"])},{append:r((()=>[u(l,{onClick:D},{default:r((()=>a[8]||(a[8]=[c("搜索")]))),_:1})])),_:1},8,["modelValue"])]),i((s(),v(J,{data:g.value,style:{width:"100%"}},{default:r((()=>[u(E,{prop:"course_id",label:"课程ID",width:"220"}),u(E,{prop:"course_name",label:"课程名称","min-width":"200"}),u(E,{prop:"created_at",label:"创建时间",width:"180"}),u(E,{prop:"updated_at",label:"更新时间",width:"180"}),u(E,{label:"操作",fixed:"right",width:"200"},{default:r((({row:e})=>[u(F,null,{default:r((()=>[u(l,{type:"primary",link:"",onClick:a=>(e=>{z.value="edit",j.value=e.course_id,L.value={course_name:e.course_name},x.value=!0})(e)},{default:r((()=>a[9]||(a[9]=[c("编辑")]))),_:2},1032,["onClick"]),u(l,{type:"danger",link:"",onClick:a=>(async e=>{try{await f.confirm("确定要删除该课程吗？","提示",{type:"warning"}),await m.deleteCourse(e.course_id),_.success("删除成功"),await S()}catch(a){"cancel"!==a&&_.error("删除失败")}})(e)},{default:r((()=>a[10]||(a[10]=[c("删除")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[W,k.value]]),d("div",C,[u(M,{"current-page":U.value,"onUpdate:currentPage":a[1]||(a[1]=e=>U.value=e),"page-size":I.value,"onUpdate:pageSize":a[2]||(a[2]=e=>I.value=e),"page-sizes":[10,20,50,100],total:q.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:G},null,8,["current-page","page-size","total"])])])),_:1}),u(T,{modelValue:x.value,"onUpdate:modelValue":a[5]||(a[5]=e=>x.value=e),title:"add"===z.value?"新增课程":"编辑课程",width:"500px"},{footer:r((()=>[d("span",b,[u(l,{onClick:a[4]||(a[4]=e=>x.value=!1)},{default:r((()=>a[11]||(a[11]=[c("取消")]))),_:1}),u(l,{type:"primary",onClick:R},{default:r((()=>a[12]||(a[12]=[c("确定")]))),_:1})])])),default:r((()=>[u(Q,{ref_key:"formRef",ref:A,model:L.value,rules:P,"label-width":"100px"},{default:r((()=>[u(O,{label:"课程名称",prop:"course_name"},{default:r((()=>[u(B,{modelValue:L.value.course_name,"onUpdate:modelValue":a[3]||(a[3]=e=>L.value.course_name=e),placeholder:"请输入课程名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-daec6570"]]);export{k as default};
