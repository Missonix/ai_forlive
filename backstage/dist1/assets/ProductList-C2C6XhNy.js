import{x as a,r as e,h as l,y as t,P as u,H as r,ag as d,z as o,A as i,I as n,a4 as s,L as c,aq as p,G as v}from"./vue-vendor-B0tYOcBV.js";import{p as m}from"./product-DgBplGEn.js";import{a as _,c as f}from"./element-plus-4dk9whhS.js";import{_ as g}from"./_plugin-vue_export-helper-B34n5pss.js";const h={class:"product-list"},y={class:"card-header"},w={class:"search-bar"},b={class:"pagination-container"},k={class:"dialog-footer"},C=g(a({__name:"ProductList",setup(a){const g=e([]),C=e(!1),V=e(""),x=e(!1),P=e("add"),z=e(""),j=e(1),U=e(10),I=e(0),A=e(),q=e({ai_product_name:""}),L={ai_product_name:[{required:!0,message:"请输入产品名称",trigger:"blur"},{min:2,max:50,message:"产品名称长度在2-50个字符之间",trigger:"blur"}]},S=async()=>{try{C.value=!0;const a=await m.getAllProducts(j.value,U.value);g.value=a.data.data.items,I.value=a.data.data.total}catch(a){_.error("获取产品列表失败")}finally{C.value=!1}},D=async()=>{if(!V.value)return j.value=1,void(await S());try{C.value=!0;const a=await m.searchProduct(V.value);200===a.data.code?(g.value=a.data.data.items,I.value=a.data.data.total,0===g.value.length&&_.info("未找到匹配的产品")):_.error(a.data.message||"搜索失败")}catch(a){_.error("搜索产品失败")}finally{C.value=!1}},G=a=>{j.value=a,S()},H=a=>{U.value=a,j.value=1,S()},K=()=>{P.value="add",q.value={ai_product_name:""},x.value=!0},R=async()=>{A.value&&await A.value.validate((async a=>{if(a)try{"add"===P.value?(await m.createProduct(q.value),_.success("创建成功")):(await m.updateProduct(z.value,q.value),_.success("更新成功")),x.value=!1,await S()}catch(e){_.error("add"===P.value?"创建失败":"更新失败")}}))};return l((()=>{S()})),(a,e)=>{const l=d("el-button"),B=d("el-input"),E=d("el-table-column"),F=d("el-button-group"),J=d("el-table"),M=d("el-pagination"),N=d("el-card"),O=d("el-form-item"),Q=d("el-form"),T=d("el-dialog"),W=p("loading");return o(),t("div",h,[u(N,null,{header:r((()=>[i("div",y,[e[7]||(e[7]=i("span",null,"AI产品管理",-1)),u(l,{type:"primary",onClick:K},{default:r((()=>e[6]||(e[6]=[c("新增产品")]))),_:1})])])),default:r((()=>[i("div",w,[u(B,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),placeholder:"请输入产品名称搜索",class:"search-input",onKeyup:s(D,["enter"])},{append:r((()=>[u(l,{onClick:D},{default:r((()=>e[8]||(e[8]=[c("搜索")]))),_:1})])),_:1},8,["modelValue"])]),n((o(),v(J,{data:g.value,style:{width:"100%"}},{default:r((()=>[u(E,{prop:"ai_product_id",label:"产品ID",width:"220"}),u(E,{prop:"ai_product_name",label:"产品名称","min-width":"200"}),u(E,{prop:"created_at",label:"创建时间",width:"180"}),u(E,{label:"操作",fixed:"right",width:"200"},{default:r((({row:a})=>[u(F,null,{default:r((()=>[u(l,{type:"primary",link:"",onClick:e=>(a=>{P.value="edit",z.value=a.ai_product_id,q.value={ai_product_name:a.ai_product_name},x.value=!0})(a)},{default:r((()=>e[9]||(e[9]=[c("编辑")]))),_:2},1032,["onClick"]),u(l,{type:"danger",link:"",onClick:e=>(async a=>{try{await f.confirm("确定要删除该产品吗？","提示",{type:"warning"}),await m.deleteProduct(a.ai_product_id),_.success("删除成功"),await S()}catch(e){"cancel"!==e&&_.error("删除失败")}})(a)},{default:r((()=>e[10]||(e[10]=[c("删除")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[W,C.value]]),i("div",b,[u(M,{"current-page":j.value,"onUpdate:currentPage":e[1]||(e[1]=a=>j.value=a),"page-size":U.value,"onUpdate:pageSize":e[2]||(e[2]=a=>U.value=a),"page-sizes":[10,20,50,100],total:I.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:G},null,8,["current-page","page-size","total"])])])),_:1}),u(T,{modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=a=>x.value=a),title:"add"===P.value?"新增产品":"编辑产品",width:"500px"},{footer:r((()=>[i("span",k,[u(l,{onClick:e[4]||(e[4]=a=>x.value=!1)},{default:r((()=>e[11]||(e[11]=[c("取消")]))),_:1}),u(l,{type:"primary",onClick:R},{default:r((()=>e[12]||(e[12]=[c("确定")]))),_:1})])])),default:r((()=>[u(Q,{ref_key:"formRef",ref:A,model:q.value,rules:L,"label-width":"100px"},{default:r((()=>[u(O,{label:"产品名称",prop:"ai_product_name"},{default:r((()=>[u(B,{modelValue:q.value.ai_product_name,"onUpdate:modelValue":e[3]||(e[3]=a=>q.value.ai_product_name=a),placeholder:"请输入产品名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-0218e7c4"]]);export{C as default};
